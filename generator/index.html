<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>App Roles Manifest Generator</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="highlight/styles/default.css">
    <script src="highlight/highlight.pack.js"></script>
</head>

<body>
<h1>App Roles Manifest Generator</h1>

    <div class="inputText">
        <label for="inputText">Your Json input
            <br><textarea id="inputText" rows="20" cols="50"></textarea>
        </label>
        <br><button id="run">Generate</button>
    </div>
<br>
<div id="result" class="col1">
    <div class="col1">Input<pre><code id="start" class="json"></code></pre></div>
    <div class="col1">App Roles Output<pre><code id="end" class="json"></code></pre></div>
</div>
<p>Brought to you by <a href=https://github.com/jyapurv/manifest>Manifest Project</a>, thanks to the contributions of @jyapurv and @grubhart</p>
</body>

<script>
    hljs.initHighlightingOnLoad();
    function prettyFy(text) {
        var objJson = JSON.parse(text);
        var formattedText = JSON.stringify(objJson, null, 2);
        return formattedText;
    }

    $('#run').click(function(){
        $("div:hidden").show("slow");
        $.ajax({
            url: 'https://pe-generatemanifest.azurewebsites.net/api/GenerateManifest',
            type: 'post',
            contentType: "application/json; charset=utf-8",
            data: $('#inputText').val(),
            headers: {
                'Access-Control-Allow-Origin': 'https://stgmanifest.z20.web.core.windows.net',
                'Access-Control-Allow-Methods': 'POST'
            },
            dataType: 'text',
            success: function (data) {
                $('#end').text(prettyFy(data));
            },
            error: function(){
                $('#end').text("Error, review your JSON input");
            }
        });
        $('#start').text(prettyFy($('#inputText').val()));
        hljs.highlightBlock(document.getElementById("start"));
        hljs.highlightBlock(document.getElementById("end"));
    });
</script>
</html>